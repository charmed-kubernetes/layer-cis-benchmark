cis-benchmark:
  description: |
    Run the CIS Kubernetes Benchmark against snap-based components.
  params:
    config:
      type: string
      default: 'https://github.com/charmed-kubernetes/kube-bench-config/archive/master.zip#sha1=4a6f7a092ff893ab7a5e2e6596e91a7eeacdfce4'
      description: |
        Archive containing configuration files to use when running kube-bench.
        The default value is known to be compatible with snap components. When
        using a custom URL, append '#<hash_type>=<checksum>' to verify the
        archive integrity when downloaded.
    release:
      type: string
      default: 'upstream'
      description: |
        Set the kube-bench release to run. The default value of 'upstream'
        will compile and use a local kube-bench binary built from the master
        branch of the upstream repository:
          https://github.com/aquasecurity/kube-bench

        This value may also be set to an accessible archive containing a
        pre-built kube-bench binary, for example:
          https://github.com/aquasecurity/kube-bench/releases/download/v0.0.34/kube-bench_0.0.34_linux_amd64.tar.gz#sha256=f96d1fcfb84b18324f1299db074d41ef324a25be5b944e79619ad1a079fca077
