cis-benchmark:
  description: |
    Run the CIS Kubernetes Benchmark against snap-based components.
  params:
    apply:
      type: string
      default: 'none'
      description: |
        Apply remediations to address benchmark failures. The default, 'none',
        will not attempt to fix any reported failures. Set to 'conservative'
        to resolve simple failures. Set to 'dangerous' to attempt to resolve
        all failures.

        Note: Applying any remediation may result in an unusable cluster.
    config:
      type: string
      default: 'https://github.com/charmed-kubernetes/kube-bench-config/archive/cis-1.5.zip#sha1=cb8e78712ee5bfeab87d0ed7c139a83e88915530'
      description: |
        Archive containing configuration files to use when running kube-bench.
        The default value is known to be compatible with snap components. When
        using a custom URL, append '#<hash_type>=<checksum>' to verify the
        archive integrity when downloaded.
    release:
      type: string
      default: 'https://github.com/aquasecurity/kube-bench/releases/download/v0.2.3/kube-bench_0.2.3_linux_amd64.tar.gz#sha256=429a1db271689aafec009434ded1dea07a6685fee85a1deea638097c8512d548'
      description: |
        Set the kube-bench release to run. If set to 'upstream', the action
        will compile and use a local kube-bench binary built from the master
        branch of the upstream repository:
          https://github.com/aquasecurity/kube-bench

        This value may also be set to an accessible archive containing a
        pre-built kube-bench binary, for example:
          https://github.com/aquasecurity/kube-bench/releases/download/v0.0.34/kube-bench_0.0.34_linux_amd64.tar.gz#sha256=f96d1fcfb84b18324f1299db074d41ef324a25be5b944e79619ad1a079fca077
